# API Ranking Documentation\n\n## Tá»•ng quan\nTÃ´i Ä‘Ã£ táº¡o hoÃ n chá»‰nh API ranking cho trang báº£ng xáº¿p háº¡ng ngÆ°á»i bÃ¡o cÃ¡o vá»›i cÃ¡c chá»©c nÄƒng sau:\n\n## ğŸš€ API Endpoints Ä‘Ã£ táº¡o\n\n### 1. GET `/api/v1/report/ranking`\n**Má»¥c Ä‘Ã­ch**: Láº¥y báº£ng xáº¿p háº¡ng vá»›i phÃ¢n trang\n\n**Parameters**:\n- `page` (optional): Sá»‘ trang (báº¯t Ä‘áº§u tá»« 0, máº·c Ä‘á»‹nh 0)\n- `size` (optional): Sá»‘ items má»—i trang (máº·c Ä‘á»‹nh 10)\n\n**Response**:\n```json\n{\n  \"reporters\": [\n    {\n      \"rank\": 1,\n      \"email\": \"user@example.com\",\n      \"approvedReports\": 25,\n      \"totalReports\": 30,\n      \"successRate\": 83.33,\n      \"firstReportDate\": \"2024-01-15T10:30:00\",\n      \"lastReportDate\": \"2024-06-18T14:20:00\"\n    }\n  ],\n  \"currentPage\": 0,\n  \"totalPages\": 10,\n  \"totalElements\": 100,\n  \"pageSize\": 10\n}\n```\n\n### 2. GET `/api/v1/report/ranking/top3`\n**Má»¥c Ä‘Ã­ch**: Láº¥y top 3 Ä‘á»ƒ hiá»ƒn thá»‹ podium\n\n**Response**:\n```json\n[\n  {\n    \"rank\": 1,\n    \"email\": \"top1@example.com\",\n    \"approvedReports\": 184,\n    \"totalReports\": 200,\n    \"successRate\": 92.0,\n    \"firstReportDate\": \"2023-12-01T08:00:00\",\n    \"lastReportDate\": \"2024-06-18T16:45:00\"\n  },\n  // ... top 2 vÃ  3\n]\n```\n\n### 3. GET `/api/v1/report/ranking/stats`\n**Má»¥c Ä‘Ã­ch**: Láº¥y thá»‘ng kÃª tá»•ng quan\n\n**Response**:\n```json\n{\n  \"totalReporters\": 1250,\n  \"totalApprovedReports\": 8460,\n  \"averageSuccessRate\": 78.5\n}\n```\n\n## ğŸ—ï¸ Cáº¥u trÃºc Database\n\n### Report Entity\n- `emailAuthorReport`: Email ngÆ°á»i bÃ¡o cÃ¡o\n- `status`: Tráº¡ng thÃ¡i (1=PENDING, 2=APPROVED, 3=REJECTED)\n- `dateReport`: NgÃ y bÃ¡o cÃ¡o\n\n### StatusReportEnum\n- `PENDING(1)`: Chá» xá»­ lÃ½\n- `APPROVED(2)`: ÄÃ£ Ä‘Æ°á»£c duyá»‡t âœ…\n- `REJECTED(3)`: ÄÃ£ bá»‹ tá»« chá»‘i\n\n## ğŸ“Š Logic Ranking\n\n### Äiá»u kiá»‡n xáº¿p háº¡ng:\n1. **Chá»‰ tÃ­nh bÃ¡o cÃ¡o Ä‘Æ°á»£c duyá»‡t** (`status = 2`)\n2. **Sáº¯p xáº¿p theo sá»‘ bÃ¡o cÃ¡o Ä‘Æ°á»£c duyá»‡t** (giáº£m dáº§n)\n3. **TÃ­nh tá»· lá»‡ thÃ nh cÃ´ng** = (Sá»‘ bÃ¡o cÃ¡o Ä‘Æ°á»£c duyá»‡t / Tá»•ng sá»‘ bÃ¡o cÃ¡o) Ã— 100\n\n### SQL Query chÃ­nh:\n```sql\nSELECT \n    ROW_NUMBER() OVER (ORDER BY COUNT(CASE WHEN status = 2 THEN 1 END) DESC) as rank,\n    emailAuthorReport,\n    COUNT(CASE WHEN status = 2 THEN 1 END) as approvedReports,\n    COUNT(*) as totalReports,\n    ROUND((COUNT(CASE WHEN status = 2 THEN 1 END) * 100.0 / COUNT(*)), 2) as successRate,\n    MIN(dateReport) as firstReportDate,\n    MAX(dateReport) as lastReportDate\nFROM Report \nWHERE emailAuthorReport IS NOT NULL\nGROUP BY emailAuthorReport\nHAVING COUNT(*) > 0\nORDER BY COUNT(CASE WHEN status = 2 THEN 1 END) DESC\n```\n\n## ğŸ¨ Frontend Integration\n\n### RankingService Ä‘Ã£ táº¡o\n- `getReporterRanking(page, size)`: Láº¥y ranking vá»›i phÃ¢n trang\n- `getTop3Reporters()`: Láº¥y top 3\n- `getRankingStats()`: Láº¥y thá»‘ng kÃª\n\n### Component Features\n- âœ… **Loading states** vá»›i spinner\n- âœ… **Error handling** vá»›i retry button\n- âœ… **Responsive design** \n- âœ… **Email masking** Ä‘á»ƒ báº£o vá»‡ privacy\n- âœ… **Real-time stats** \n- âœ… **Beautiful animations**\n\n## ğŸ”§ CÃ¡ch sá»­ dá»¥ng\n\n### 1. Start Backend\n```bash\ncd CheckScam-backend\n./mvnw spring-boot:run\n```\n\n### 2. Update API URL\nTrong `ranking.service.ts`, Ä‘áº£m báº£o `apiUrl` Ä‘Ãºng:\n```typescript\nprivate apiUrl = 'http://localhost:8080/api/v1/report';\n```\n\n### 3. Test API\n```bash\n# Test ranking endpoint\ncurl \"http://localhost:8080/api/v1/report/ranking?page=0&size=10\"\n\n# Test top 3\ncurl \"http://localhost:8080/api/v1/report/ranking/top3\"\n\n# Test stats\ncurl \"http://localhost:8080/api/v1/report/ranking/stats\"\n```\n\n## ğŸ“ LÆ°u Ã½ quan trá»ng\n\n### Database Requirements\n1. Cáº§n cÃ³ dá»¯ liá»‡u trong báº£ng `Report`\n2. TrÆ°á»ng `emailAuthorReport` khÃ´ng Ä‘Æ°á»£c null\n3. TrÆ°á»ng `status` pháº£i cÃ³ giÃ¡ trá»‹ há»£p lá»‡ (1,2,3)\n\n### Performance\n- ÄÃ£ thÃªm **index** cho `date_report DESC`\n- Query Ä‘Æ°á»£c tá»‘i Æ°u vá»›i `ROW_NUMBER()` window function\n- Pagination Ä‘á»ƒ trÃ¡nh load quÃ¡ nhiá»u dá»¯ liá»‡u\n\n### Privacy\n- Email Ä‘Æ°á»£c **mask** á»Ÿ frontend: `us***r@gmail.com`\n- KhÃ´ng lÆ°u trá»¯ thÃ´ng tin cÃ¡ nhÃ¢n nháº¡y cáº£m\n\n## ğŸ¯ Káº¿t quáº£\n\nBáº¡n sáº½ cÃ³:\n1. **API hoÃ n chá»‰nh** vá»›i 3 endpoints\n2. **Frontend component** vá»›i design Ä‘áº¹p\n3. **Real-time data** tá»« database\n4. **PhÃ¢n trang 10 items** nhÆ° yÃªu cáº§u\n5. **Top 3 podium** vá»›i rewards\n6. **Statistics cards** Ä‘á»™ng\n7. **Error handling** professional\n\nğŸš€ **API Ä‘Ã£ sáºµn sÃ ng sá»­ dá»¥ng!**\n