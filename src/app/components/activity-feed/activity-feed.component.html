<div class="activity-feed-container">
  <!-- Header vá»›i CheckScam branding -->
  <div class="header">
    <div class="header-content">
      <div class="title-section">
        <div class="checkscam-logo">
          <div class="status-indicator" [class.connected]="isConnected"></div>
          <div class="logo-text">
            <h1>ğŸ›¡ï¸ CheckScam</h1>
            <p>Hoáº¡t Ä‘á»™ng báº£o vá»‡ thá»i gian thá»±c</p>
          </div>
        </div>
      </div>
      
      <div class="controls">
        <select [(ngModel)]="currentFilter" (change)="onFilterChange()" class="filter-select">
          <option value="all">Táº¥t cáº£ hoáº¡t Ä‘á»™ng</option>
          <option value="post">ğŸ“ ÄÄƒng tin tá»©c</option>
          <option value="report">ğŸ“¤ Gá»­i bÃ¡o cÃ¡o</option>
          <option value="join">ğŸ‘¥ Tham gia</option>
        </select>
        
        <button class="btn btn-primary" (click)="openCreateModal()">
          â• Táº¡o hoáº¡t Ä‘á»™ng
        </button>
        
        <button class="btn btn-warning" (click)="openDangerousModal()">
          âš ï¸ Hoáº¡t Ä‘á»™ng nguy hiá»ƒm
        </button>
        
        <button class="btn btn-danger" (click)="clearFeed()">
          ğŸ—‘ï¸ XÃ³a feed
        </button>
      </div>
    </div>
    
    <!-- Statistics bar cho CheckScam -->
    <div class="stats-bar">
      <div class="stat-item post">
        <span class="stat-icon">ğŸ“</span>
        <div class="stat-content">
          <span class="stat-label">Tin tá»©c:</span>
          <span class="stat-value">{{ stats.totalPosts }}</span>
        </div>
      </div>
      <div class="stat-item report">
        <span class="stat-icon">ğŸ“¤</span>
        <div class="stat-content">
          <span class="stat-label">BÃ¡o cÃ¡o:</span>
          <span class="stat-value">{{ stats.totalReports }}</span>
        </div>
      </div>
      <div class="stat-item join">
        <span class="stat-icon">ğŸ‘¥</span>
        <div class="stat-content">
          <span class="stat-label">Tham gia:</span>
          <span class="stat-value">{{ stats.totalJoins }}</span>
        </div>
      </div>
      <div class="stat-item online">
        <span class="stat-icon">ğŸ‘¥</span>
        <div class="stat-content">
          <span class="stat-label">Online:</span>
          <span class="stat-value">{{ stats.connectedClients }}</span>
        </div>
      </div>
      <div class="stat-item connection">
        <span class="stat-icon">ğŸ”—</span>
        <div class="stat-content">
          <span class="stat-label">Káº¿t ná»‘i:</span>
          <span class="stat-value">{{ isConnected ? 'ÄÃ£ káº¿t ná»‘i' : 'Máº¥t káº¿t ná»‘i' }}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Activity Feed -->
  <div class="activity-feed">
    <div *ngIf="isLoading" class="loading">
      <div class="spinner"></div>
      <span>Äang táº£i hoáº¡t Ä‘á»™ng CheckScam...</span>
    </div>

    <div *ngIf="!isLoading && activities.length === 0" class="no-activities">
      <span>ChÆ°a cÃ³ hoáº¡t Ä‘á»™ng nÃ o</span>
    </div>

    <div *ngFor="let activity of activities" 
         [class]="getActivityItemClass(activity)"
         (click)="onActivityClick(activity)"
         [style.cursor]="canNavigate(activity) ? 'pointer' : 'default'">
      <img [src]="activity.user.avatar" [alt]="activity.user.name" class="avatar">
      <div class="content">
        <div class="user-name">{{ activity.user.name }}</div>
        <div class="action">
          <span class="activity-icon">{{ getActionIcon(activity.actionType) }}</span>
          {{ getActionText(activity.actionType) }} 
          <span class="target">"{{ activity.targetName }}"</span>
          <span *ngIf="canNavigate(activity)" class="clickable-hint">Â â†’ Xem chi tiáº¿t</span>
        </div>
        
        <div *ngIf="activity.metadata" class="metadata">
          <span *ngFor="let tag of renderMetadata(activity.metadata)" 
                class="metadata-tag" 
                [ngClass]="tag.class">
            {{ tag.text }}
          </span>
        </div>
        
        <div class="time">
          ğŸ•’ {{ getTimeAgo(activity.createdAt) }}
          <a *ngIf="activity.targetUrl" 
             [href]="activity.targetUrl" 
             target="_blank" 
             rel="noopener"
             (click)="$event.stopPropagation()">
            ğŸ”— Xem chi tiáº¿t
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal táº¡o activity -->
<div *ngIf="showCreateModal" class="modal" (click)="closeCreateModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Táº¡o hoáº¡t Ä‘á»™ng CheckScam</h3>
      <span class="close" (click)="closeCreateModal()">&times;</span>
    </div>
    
    <form (ngSubmit)="createActivity()" #createFormRef="ngForm">
      <div class="form-group">
        <label for="userId">NgÆ°á»i dÃ¹ng:</label>
        <select [(ngModel)]="createForm.user_id" name="user_id" required>
          <option value="1">Nguyá»…n ThÃ nh HÆ°ng</option>
          <option value="2">XuÃ¢n Dong Ho</option>
          <option value="3">LÃª VÄƒn Kháº£i</option>
          <option value="4">CheckScam Admin</option>
          <option value="5">Minh Tuáº¥n</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="actionType">Loáº¡i hoáº¡t Ä‘á»™ng:</label>
        <select [(ngModel)]="createForm.action_type" name="action_type" required>
          <option value="post">ğŸ“ ÄÄƒng tin tá»©c</option>
          <option value="report">ğŸ“¤ Gá»­i bÃ¡o cÃ¡o</option>
          <option value="join">ğŸ‘¥ Tham gia</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="targetType">Loáº¡i Ä‘á»‘i tÆ°á»£ng:</label>
        <select [(ngModel)]="createForm.target_type" name="target_type">
          <option value="news">ğŸ“° Tin tá»©c</option>
          <option value="report">ğŸ“‹ BÃ¡o cÃ¡o</option>
          <option value="community">ğŸ‘¥ Cá»™ng Ä‘á»“ng</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="targetName">MÃ´ táº£ hoáº¡t Ä‘á»™ng:</label>
        <input type="text" 
               [(ngModel)]="createForm.target_name"
               name="target_name"
               placeholder="VD: Cáº£nh bÃ¡o: Website lá»«a Ä‘áº£o má»›i xuáº¥t hiá»‡n" 
               required>
      </div>
      
      <div class="form-group">
        <label for="targetUrl">URL (tÃ¹y chá»n):</label>
        <input type="url" 
               [(ngModel)]="createForm.target_url"
               name="target_url"
               placeholder="https://suspicious-website.com">
      </div>
      
      <div class="form-group">
        <label for="metadata">Metadata (JSON):</label>
        <textarea [(ngModel)]="createForm.metadata"
                  name="metadata"
                  rows="3"
                  placeholder='{"category": "warning", "priority": "high"}'></textarea>
      </div>
      
      <div class="form-actions">
        <button type="button" class="btn btn-secondary" (click)="closeCreateModal()">Há»§y</button>
        <button type="submit" class="btn btn-primary">Táº¡o hoáº¡t Ä‘á»™ng</button>
      </div>
    </form>
  </div>
</div>

<!-- Modal hoáº¡t Ä‘á»™ng nguy hiá»ƒm -->
<div *ngIf="showDangerousModal" class="modal" (click)="closeDangerousModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>âš ï¸ Hoáº¡t Ä‘á»™ng nguy hiá»ƒm gáº§n Ä‘Ã¢y</h3>
      <span class="close" (click)="closeDangerousModal()">&times;</span>
    </div>
    
    <div class="dangerous-list">
      <div *ngIf="dangerousActivities.length === 0" class="loading">
        <span>KhÃ´ng cÃ³ hoáº¡t Ä‘á»™ng nguy hiá»ƒm nÃ o</span>
      </div>
      
      <div *ngFor="let activity of dangerousActivities" class="dangerous-item">
        <h4>{{ getActionIcon(activity.actionType) }} {{ activity.targetName }}</h4>
        <p><strong>NgÆ°á»i dÃ¹ng:</strong> {{ activity.user.name }}</p>
        <p><strong>Thá»i gian:</strong> {{ getTimeAgo(activity.createdAt) }}</p>
        <p *ngIf="activity.metadata?.risk_level">
          <strong>Má»©c Ä‘á»™ rá»§i ro:</strong> {{ translateRiskLevel(activity.metadata.risk_level) }}
        </p>
        <p *ngIf="activity.metadata?.result">
          <strong>Káº¿t quáº£:</strong> {{ translateResult(activity.metadata.result) }}
        </p>
        <p *ngIf="activity.metadata?.confidence">
          <strong>Äá»™ tin cáº­y:</strong> {{ activity.metadata.confidence }}%
        </p>
      </div>
    </div>
  </div>
</div>